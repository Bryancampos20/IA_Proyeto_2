/home/miguel/Desktop/IA_Proyeto_2/proyecto2.py:56: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
--- Epoch [1/5] ---
Traceback (most recent call last):
  File "/home/miguel/Desktop/IA_Proyeto_2/proyecto2.py", line 290, in <module>
    val_loss, val_accuracy = validate(model_a, val_loader, criterion, device, "Model_A", "Raw_Data", epoch)
  File "/home/miguel/Desktop/IA_Proyeto_2/proyecto2.py", line 212, in validate
    plot_confusion_matrix(all_labels, all_predictions, class_names, model_name, dataset_name)
  File "/home/miguel/Desktop/IA_Proyeto_2/proyecto2.py", line 183, in plot_confusion_matrix
    plt.show()
  File "/home/miguel/.local/lib/python3.10/site-packages/matplotlib/pyplot.py", line 421, in show
    return _get_backend_mod().show(*args, **kwargs)
  File "/home/miguel/.local/lib/python3.10/site-packages/matplotlib/backend_bases.py", line 3546, in show
    cls.mainloop()
  File "/home/miguel/.local/lib/python3.10/site-packages/matplotlib/backends/backend_qt.py", line 1021, in mainloop
    with _maybe_allow_interrupt(qapp):
  File "/usr/lib/python3.10/contextlib.py", line 142, in __exit__
    next(self.gen)
  File "/home/miguel/.local/lib/python3.10/site-packages/matplotlib/backends/qt_compat.py", line 269, in _maybe_allow_interrupt
    old_sigint_handler(*handler_args)
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/miguel/Desktop/IA_Proyeto_2/proyecto2.py", line 290, in <module>
    val_loss, val_accuracy = validate(model_a, val_loader, criterion, device, "Model_A", "Raw_Data", epoch)
  File "/home/miguel/Desktop/IA_Proyeto_2/proyecto2.py", line 212, in validate
    plot_confusion_matrix(all_labels, all_predictions, class_names, model_name, dataset_name)
  File "/home/miguel/Desktop/IA_Proyeto_2/proyecto2.py", line 183, in plot_confusion_matrix
    plt.show()
  File "/home/miguel/.local/lib/python3.10/site-packages/matplotlib/pyplot.py", line 421, in show
    return _get_backend_mod().show(*args, **kwargs)
  File "/home/miguel/.local/lib/python3.10/site-packages/matplotlib/backend_bases.py", line 3546, in show
    cls.mainloop()
  File "/home/miguel/.local/lib/python3.10/site-packages/matplotlib/backends/backend_qt.py", line 1021, in mainloop
    with _maybe_allow_interrupt(qapp):
  File "/usr/lib/python3.10/contextlib.py", line 142, in __exit__
    next(self.gen)
  File "/home/miguel/.local/lib/python3.10/site-packages/matplotlib/backends/qt_compat.py", line 269, in _maybe_allow_interrupt
    old_sigint_handler(*handler_args)
KeyboardInterrupt